<!--
px.dealer Object providing API for dealer

#### Usage
```
    var deckDefinition = {
        'sample-cards': {
            name: 'SampleCards',
            url: 'views/sample-cards.html'
        },
        'fetch-data': {
            name: 'FetchData',
            url: 'views/fetch-data.html'
        },
        'card-to-card': {
            name: 'CardToCard',
            url: 'views/card-to-card.html'
        }
    };

    var decksByClassification = {
        'dashboard1': {
            '/classification/country': ['sample-cards', 'fetch-data'],
            '/classification/state': ['card-to-card'],
            '/classification/county': ['sample-cards', 'card-to-card', 'fetch-data']
        },
        'dashboard2': {
            '/classification/country': ['sample-cards', 'fetch-data'],
            '/classification/state': ['card-to-card'],
            '/classification/county': ['sample-cards', 'card-to-card', 'fetch-data']
        }
    };

    window.px.dealer.init(deckDefinition, decksByClassification);

    $scope.$apply(function () {

        $scope.context = {
            name: 'newContextName'
        }; //new context could be set by opening up a context in context browser, please see Predix seed app for integration with Predix Asset

        window.px.dealer.getDecksByClassification('dashboard1', $scope.context.classification).then(function(decks){
            $scope.decks = decks;

            if ($scope.decks.length) {
                $scope.selectedDeck = $scope.decks[0].url;
            }
        });
    });

```

#### px.dealer api

##### methods

```
    getData: function (url) {
        //get data from web resources by url
    },
```
```
    init: function (deckDefinitions, decksByClassifications) {
        //instantiate the dealer by setting up deck definition and deckByClassification for getDecksByClassification look up
    },
```
```
    getDecksByClassification: function (dashboardId, classification) {
        //get a list of decks by dashboard Id and classification
    },
```
```
    getDeck: function (url) {
        //get the deck markup by url
    }
```

-->
<script type="text/javascript">
    (function () {
        window.px = window.px || {};
        //angular implementation pf px-dealer
        window.px.dealer = {
            getData: function (url) {
                if (window.angular) {
                    //throw 'angular is missing';
                    var $http = angular.element('body').injector().get("$http");

                    return new Promise(function (resolve, reject) {
                        $http.get(url).
                                success(function (data, status, headers, config) {
                                    resolve(data);
                                }).
                                error(function (data, status, headers, config) {
                                    reject(data);
                                });
                    });
                }
            },
            init: function (deckDefintions, decksByClassifications) {
                this.deckDefinitions = deckDefintions;
                this.decksByClassification = decksByClassifications;
            },
            getDecksByClassification: function (dashboardId, classification) {
                var decks = [];
                var self = this;
                if (dashboardId && dashboardId in this.decksByClassification) {
                    var decksInDashboard = this.decksByClassification[dashboardId];

                    if (classification in decksInDashboard) {
                        decksInDashboard[classification].forEach(function (deckId) {
                            if (self.deckDefinitions[deckId]) {
                                decks.push(self.deckDefinitions[deckId]);
                            }
                        });
                    }
                }

                return new Promise(function (resolve, reject) {
                    resolve(decks);
                });
            },
            getDeck: function (url) {
                return this.getData(url);
            }
        };


    })();

    Polymer({
        is: 'px-dealer',
        behaviors: [px.dealer]
    });
</script>
