<!doctype html>

<html>
    <head>
        <title>px-card Demo</title>

        <!-- Requires Webcomponents.js polyfill is provided by the page for browsers that don't support html imports -->
        <script src="../webcomponentsjs/webcomponents.js"></script>

        <!-- Import custom element. Note: see comment about relative paths to dependencies in the *.html file referenced below -->
        <link rel="import" href="../polymer/polymer.html"/>
        <link rel="import" href="px-card.html"/>
        <link rel="import" href="px-context-name.html"/>
        <link rel="import" href="px-card-controls.html"/>
        <link rel="import" type="css" href="../px-theme/px-app.html"/>

        <style>
          html{
            background-color: white !important;
          }
        </style>

    </head>

    <body>

        <h3>Demo</h3>

        <p>
            Although related, examples are /not/ the same as the test fixtures.
            Tests are tests, examples are examples.
        </p>

        <p>
            Also see the <a href="index.html">documentation</a> and the <a href="test/fixture.html">UI test fixture</a>.
        </p>


        <px-card class="a-card">
          <template is="dom-bind">
            <h1>Hello World</h1>
            <p>
              Context:
              <span>{{context.name}}</span>
            </p>
            <p>This is the bare minimum you need for a Predix Experience card.</p>
          </template>
        </px-card>

        <px-card class="another-card">
          <px-card-controls></px-card-controls>
          <template is="dom-bind">
            <px-context-name context-name="[[context.name]]"></px-context-name>
            <h1>Another Hello World with default controls</h1>
            <p>
              Context:
              <span>{{context.name}}</span>
            </p>
          </template>
        </px-card>

        <!-- <dom-module id="custom-card">
            <template>
            <div style="border:red 2px solid;">
                <content></content>
            </div>
            </template>
        </dom-module> -->
        <script>
          (function() {
            Polymer({
                is: 'custom-card',

                properties : {
                  currentTemperature: {
                    type: Number,
                    reflectToAttribute: true
                  }
                },

                /**
                 * (optionally) implement this API method to refresh your card data
                 **/
                refresh: function() {
                    console.log('refresh on custom-card!');
                },
                /**
                 * (optionally) implement this API method to do interesting stuff when the context is changed
                 **/
                contextChanged: function(newContext, oldContext) {
                    console.log('context changed on custom-card!');
                },
                /**
                 * add your own methods, such as this click handler, to do custom logic.
                 * the px card behaviors include a getData method which will handle fetching the data for you
                 **/
                getMoreTemperatureData: function(){
                    var self = this;
                    this.getData('/temperature').then(function(currentTemperature) {
                        // on fulfillment
                        self.currentTemperature = currentTemperature;
                    }, function(reason) {
                        // on rejection
                        self.currentTemperature = 'ERROR';
                    });
                },
                behaviors: [px.cardBehavior]
            });
            })();
        </script>

        <custom-card>
          <template is="dom-bind">
            <p>This is a more complex Predix Experience card.</p>
            <button on-click="getMoreTemperatureData">Get More Temperature Data</button>
            <p id="temp">Current Temperature:<span>{{currentTemperature}}</span>F</p>
          </template>
        </custom-card>

        <script>
            window.deck = {
                getData: function() {
                    return new Promise(function(resolve, reject) {
                        resolve(70);
                    });
                }
            };

            var context = {
                name: 'My Context'
            };
            window.addEventListener("WebComponentsReady", function() {
            document.querySelector('px-card.a-card').set("context", context);
            document.querySelector('px-card.another-card').set("context", context);
              document.querySelector('custom-card').set("currentTemperature", 65);
            });

        </script>
    </body>
</html>
